<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Daily Trend [12-04] | Good Morning</title><meta name="author" content="Yichen"><meta name="copyright" content="Yichen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="【1】Think before you speak: Training Language Models With Pause Tokens【URL】http:&#x2F;&#x2F;arxiv.org&#x2F;abs&#x2F;2310.02226 【Time】2023-10-03 一、研究领域 NLP，延迟推理 二、研究动机 现有的 LM 框架中，生成第 K+1 个 token 总是操作看到的前 K 个 token（而不会更多），相">
<meta property="og:type" content="article">
<meta property="og:title" content="Daily Trend [12-04]">
<meta property="og:url" content="http://y-ichen.github.io/2023/12/04/2023-12-04%20[Daily%20Trend]%206955e249abe745aa9dc053890151d4e3/index.html">
<meta property="og:site_name" content="Good Morning">
<meta property="og:description" content="【1】Think before you speak: Training Language Models With Pause Tokens【URL】http:&#x2F;&#x2F;arxiv.org&#x2F;abs&#x2F;2310.02226 【Time】2023-10-03 一、研究领域 NLP，延迟推理 二、研究动机 现有的 LM 框架中，生成第 K+1 个 token 总是操作看到的前 K 个 token（而不会更多），相">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://y-ichen.github.io/img/avatar.jpg">
<meta property="article:published_time" content="2023-12-03T16:11:28.000Z">
<meta property="article:modified_time" content="2023-12-04T03:28:55.004Z">
<meta property="article:author" content="Yichen">
<meta property="article:tag" content="read">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://y-ichen.github.io/img/avatar.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://y-ichen.github.io/2023/12/04/2023-12-04%20[Daily%20Trend]%206955e249abe745aa9dc053890151d4e3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Daily Trend [12-04]',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-04 11:28:55'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Good Morning" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">32</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Good Morning"><span class="site-name">Good Morning</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Daily Trend [12-04]</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-12-03T16:11:28.000Z" title="Created 2023-12-04 00:11:28">2023-12-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-12-04T03:28:55.004Z" title="Updated 2023-12-04 11:28:55">2023-12-04</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Daily Trend [12-04]"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="【1】Think-before-you-speak-Training-Language-Models-With-Pause-Tokens"><a href="#【1】Think-before-you-speak-Training-Language-Models-With-Pause-Tokens" class="headerlink" title="【1】Think before you speak: Training Language Models With Pause Tokens"></a>【1】Think before you speak: Training Language Models With Pause Tokens</h2><p>【URL】<a target="_blank" rel="noopener" href="http://arxiv.org/abs/2310.02226">http://arxiv.org/abs/2310.02226</a></p>
<p>【Time】2023-10-03</p>
<p>一、研究领域</p>
<p>NLP，延迟推理</p>
<p>二、研究动机</p>
<p>现有的 LM 框架中，生成第 K+1 个 token 总是操作看到的前 K 个 token（而不会更多），相反，作者希望花费超过 K 次操作来生成下一个 token，因此，作者提出通过向输入附加 M 个虚拟 token 来综合增加输入序列长度，从而将模型的下一个响应延迟 M 个输入 token。</p>
<blockquote>
<p>In the current paradigm of language models, we compute exactly K embeddings v1, . . . vK in each layer, before generating the (K + 1)th token, pK+1. Our premise is that this limit of K operations is an arbitrary one. Instead, we wish to expend more than K operations towards producing the next token, pK+1. While something to this effect could be achieved by increasing the number of attention heads in each layer, we are interested in an orthogonal approach that introduces hardly any parameters into the network. The idea is to synthetically increase the input sequence length by appending M dummy tokens to the input, thus delaying the model’s next response by M tokens of input. In effect, this M -token-delay lets the model manipulate an additional set of M intermediate vectors vK+1, . . . , vK+M before committing to its next (output) token, pK+1. Intuitively, these vectors could provide a richer representation of the input (e.g., by attending differently), thus resulting in a better next token from the model.</p>
</blockquote>
<p>三、方法与技术</p>
<p>（1）在Pretraing过程中，选用”<pause>”作为虚拟token，随机均匀地插入到预训练数据中，在训练损失中忽略”<pause>”对应的损失项。</pause></pause></p>
<p><img src="/2023/12/04/2023-12-04%20[Daily%20Trend]%206955e249abe745aa9dc053890151d4e3/Untitled.png" alt="Figure 2: Standard vs. pause-pretraining."></p>
<p>Figure 2: Standard vs. pause-pretraining.</p>
<p>（2）在Finetuning过程中，将”<pause>”插入到给定前缀的后面，构造新的前缀，但是不改变监督目标，在具有新前缀的目标上应用标准的next-token prediction loss。</pause></p>
<p><img src="/2023/12/04/2023-12-04%20[Daily%20Trend]%206955e249abe745aa9dc053890151d4e3/Untitled%201.png" alt="Figure 1: Standard vs. pause-inference (and finetuning)."></p>
<p>Figure 1: Standard vs. pause-inference (and finetuning).</p>
<p>（3）在Inference过程中，同样将”<pause>”插入到给定前缀的后面，并且和前面一样，忽略模型的输出，直到遇到最后一个<pause> token。</pause></pause></p>
<p><img src="/2023/12/04/2023-12-04%20[Daily%20Trend]%206955e249abe745aa9dc053890151d4e3/Untitled%202.png" alt="Untitled"></p>
<p>（4）作者排列组合 标准&#x2F;“暂停”(方式) 预训练&#x2F;微调(阶段) 做了很多实验，以及对<pause> token的数量、嵌入位置、嵌入阶段做了消融实验，最后得出结论：暂停训练超越了语言模型中“立即”下一个标记预测的范式。关键思想是使用（虚拟）<pause> 标记来训练模型，以便模型可以学习利用额外的推理时间计算。实验证明，如果在预训练和下游微调期间使用 <pause> 标记进行训练，这可以提高各种任务的性能。</pause></pause></pause></p>
<blockquote>
<p>Pause-training takes a step beyond the paradigm of “immediate” next-token prediction in language models. The key idea is to train models with (dummy) <pause> tokens tokens so that the model can learn to harness the additional inference-time computation. We demonstrate that this can improve performance on a variety of our tasks, if we train with <pause> tokens both during pretraining and downstream finetuning.</pause></pause></p>
</blockquote>
<p>四、总结</p>
<p>同样都是讲故事，而且方法和模型也很类似，但是写的不如Vision Transformers Need Registers这篇文章精彩，另外它总给笔者一种在“把完全不怎么work的东西写成一篇看起来很不错的文章”的感觉。</p>
<p>五、推荐相关阅读</p>
<p>Vision Transformers Need Registers</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="http://y-ichen.github.io">Yichen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://y-ichen.github.io/2023/12/04/2023-12-04%20[Daily%20Trend]%206955e249abe745aa9dc053890151d4e3/">http://y-ichen.github.io/2023/12/04/2023-12-04%20[Daily%20Trend]%206955e249abe745aa9dc053890151d4e3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/read/">read</a></div><div class="post_share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/11/29/2023-11-29%20%5BDaily%20Trend%5D%20744dda0cdf6743a39763020f8766e5c9/" title="Daily Trend [11-29]"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Daily Trend [11-29]</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/10/17/2023-10-17%20%5BDaily%20Trend%5D%20c6fbf6db83ca47788299097c9140f345/" title="Daily Trend [10-17]"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-17</div><div class="title">Daily Trend [10-17]</div></div></a></div><div><a href="/2023/10/16/2023-10-16%208a4905f46c264b90be77b731b977f16e/" title="Daily Trend [10-16]"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-16</div><div class="title">Daily Trend [10-16]</div></div></a></div><div><a href="/2023/10/19/2023-10-19%20%5BDaily%20Trend%5D%2075e69e1cb34e4bb686c06d695a01af7b/" title="Daily Trend [10-19]"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-19</div><div class="title">Daily Trend [10-19]</div></div></a></div><div><a href="/2023/10/18/2023-10-18%20%5BDaily%20Trend%5D%207346f7edd20740b7adff61f146c959b8/" title="Daily Trend [10-18]"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-18</div><div class="title">Daily Trend [10-18]</div></div></a></div><div><a href="/2023/10/24/2023-10-24%20%5BDaily%20Trend%5D%20360a1abe051e481d8c09f1fecdb9461f/" title="Daily Trend [10-24]"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-24</div><div class="title">Daily Trend [10-24]</div></div></a></div><div><a href="/2023/10/20/2023-10-20%20%5BDaily%20Trend%5D%2024fe2423d9e24d759116d43881b8c946/" title="Daily Trend [10-20]"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-20</div><div class="title">Daily Trend [10-20]</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Yichen</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">32</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Y-ichen"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="/atom.xml" target="_blank" title="RSS链接"><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%80%901%E3%80%91Think-before-you-speak-Training-Language-Models-With-Pause-Tokens"><span class="toc-number">1.</span> <span class="toc-text">【1】Think before you speak: Training Language Models With Pause Tokens</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/12/04/2023-12-04%20%5BDaily%20Trend%5D%206955e249abe745aa9dc053890151d4e3/" title="Daily Trend [12-04]">Daily Trend [12-04]</a><time datetime="2023-12-03T16:11:28.000Z" title="Created 2023-12-04 00:11:28">2023-12-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/29/2023-11-29%20%5BDaily%20Trend%5D%20744dda0cdf6743a39763020f8766e5c9/" title="Daily Trend [11-29]">Daily Trend [11-29]</a><time datetime="2023-11-28T16:15:09.000Z" title="Created 2023-11-29 00:15:09">2023-11-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/24/2023-11-24%20%5BDaily%20Trend%5D%205aa09d6a9fb84207a167a753499bca12/" title="Daily Trend [11-24]">Daily Trend [11-24]</a><time datetime="2023-11-23T16:09:41.000Z" title="Created 2023-11-24 00:09:41">2023-11-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/23/2023-11-23%20%5BDaily%20Trend%5D%204ac1840f3c34484ea3886e94d5ed704a/" title="Daily Trend [11-23]">Daily Trend [11-23]</a><time datetime="2023-11-22T16:10:40.000Z" title="Created 2023-11-23 00:10:40">2023-11-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/22/2023-11-22%20%5BDaily%20Trend%5D%20a222620bde6c4b1c8e982424af087a4e/" title="Daily Trend [11-22]">Daily Trend [11-22]</a><time datetime="2023-11-21T16:09:21.000Z" title="Created 2023-11-22 00:09:21">2023-11-22</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 By Yichen</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>